tinymce.PluginManager.add('insertdatetime', function (editor) {
  const dateTimeFormats = editor.settings.insertdatetime_formats || [
    '%H:%M:%S',
    '%Y-%m-%d',
    '%I:%M:%S %p',
    '%D',
  ];

  const weekdaysFull = [
    'Sunday',
    'Monday',
    'Tuesday',
    'Wednesday',
    'Thursday',
    'Friday',
    'Saturday',
    'Sunday',
  ];

  const weekdaysShort = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
  const monthsFull = [
    'January',
    'February',
    'March',
    'April',
    'May',
    'June',
    'July',
    'August',
    'September',
    'October',
    'November',
    'December',
  ];
  const monthsShort = [
    'Jan',
    'Feb',
    'Mar',
    'Apr',
    'May',
    'Jun',
    'Jul',
    'Aug',
    'Sep',
    'Oct',
    'Nov',
    'Dec',
  ];

  function formatDate(date, format) {
    function pad(value, length) {
      return ('' + value).padStart(length, '0');
    }

    format = format.replace(/%D/g, '%m/%d/%Y');
    format = format.replace(/%r/g, '%I:%M:%S %p');
    format = format.replace(/%Y/g, date.getFullYear());
    format = format.replace(/%y/g, '' + date.getYear());
    format = format.replace(/%m/g, pad(date.getMonth() + 1, 2));
    format = format.replace(/%d/g, pad(date.getDate(), 2));
    format = format.replace(/%H/g, pad(date.getHours(), 2));
    format = format.replace(/%M/g, pad(date.getMinutes(), 2));
    format = format.replace(/%S/g, pad(date.getSeconds(), 2));
    format = format.replace(/%I/g, pad((date.getHours() + 11) % 12 + 1, 2));
    format = format.replace(
      /%p/g,
      '' + (date.getHours() < 12 ? 'AM' : 'PM')
    );
    format = format.replace(/%B/g, editor.translate(monthsFull[date.getMonth()]));
    format = format.replace(/%b/g, editor.translate(monthsShort[date.getMonth()]));
    format = format.replace(/%A/g, editor.translate(weekdaysFull[date.getDay()]));
    format = format.replace(/%a/g, editor.translate(weekdaysShort[date.
