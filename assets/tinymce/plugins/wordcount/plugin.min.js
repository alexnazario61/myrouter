tinymce.PluginManager.add("wordcount", function(editor) {
  // Regular expression for counting words
  const wordCountRegex = editor.getParam("wordcount_countregex", /[\w\u2019\x27\-\u00C0-\u1FFF]+/g);
  // Regular expression for cleaning text
  const cleanRegex = editor.getParam("wordcount_cleanregex", /[0-9.(),;:!?%#$?\x27\x22_+=\\\/\-]*/g);

  // Function to update the word count display
  function updateWordCount() {
    const content = editor.getContent({ format: "raw" });
    let wordCount = 0;

    if (content) {
      // Replace certain characters, remove HTML tags, and apply the word count regex
      const cleanedContent = content
        .replace(/\.\.\./g, " ")
        .replace(/<.[^<>]*?>/g, " ")
        .replace(/&nbsp;|&#160;/gi, " ")
        .replace(/(\w+)(&#?[a-z0-9]+;)+(\w+)/i, "$1$3")
        .replace(/&.+?;/g, " ")
        .replace(cleanRegex, "");

      const matches = cleanedContent.match(wordCountRegex);
      if (matches) {
        wordCount = matches.length;
      }
    }

    // Update the word count display in the status bar
    editor.theme.panel.find("#wordcount").text(["Words: {0}", wordCount]);
  }

  // Update the word count when the editor is initialized
  editor.on("init", function() {
    const statusbar = editor.theme.panel && editor.theme.panel.find("#statusbar")[0];
    if (statusbar) {
      tinymce.util.Delay.setEditorTimeout(editor, function() {
        // Add a label to the status bar for displaying the word count
        statusbar.insert(
          {
            type
